# apps/hostinger/nginx-conf/default.conf
# Configuración básica HTTP para el sitio hostinger
# Servido por Nginx dentro de Docker
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    server_name _;
    root /usr/share/nginx/html;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ =404;
    }

    location /.well-known/acme-challenge/ {
        # Usar alias para apuntar directamente al directorio montado en el contenedor
        alias /var/www/letsencrypt/challenges-in-container/;
        # try_files $uri =404; # Opcional: devolver 404 si el archivo no existe
    }

    # --- Cabeceras de seguridad básicas (Recomendado) ---
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
    # Considera añadir una Content-Security-Policy más estricta según tu aplicación
    # add_header Content-Security-Policy "default-src 'self'; ...";

    # --- Logs (Opcional - Docker gestiona logs del contenedor) ---
    # access_log /var/log/nginx/hostinger.access.log;
    # error_log /var/log/nginx/hostinger.error.log;
}

# --- Bloque SSL (Para Fase 3+) ---
# Descomentar y configurar cuando implementemos HTTPS
# server {
#     listen 443 ssl http2 default_server;
#     listen [::]:443 ssl http2 default_server;
#     server_name _; # Reemplazar con dominio real

#     # Certificados (mapeados desde /etc/letsencrypt via docker-compose)
#     # Asegúrate que la ruta coincida con el nombre del certificado generado por Certbot
#     ssl_certificate /etc/letsencrypt/live/hostinger/fullchain.pem; # Ajustar si el nombre del cert difiere
#     ssl_certificate_key /etc/letsencrypt/live/hostinger/privkey.pem; # Ajustar si el nombre del cert difiere

#     # Incluir configuraciones de seguridad SSL (ej. generadas o estándar)
#     # include /etc/nginx/conf.d/options-ssl-nginx.conf; # Necesitarías montar este archivo también
#     # ssl_dhparam /etc/nginx/conf.d/ssl-dhparams.pem; # Necesitarías montar este archivo también

#     # Resto de la configuración (root, index, locations) similar al bloque HTTP
#     root /usr/share/nginx/html;
#     index index.html index.htm;
#     location / { try_files $uri $uri/ =404; }
#     location /.well-known/acme-challenge/ { root /usr/share/nginx/html/acme-challenges; }
# }
