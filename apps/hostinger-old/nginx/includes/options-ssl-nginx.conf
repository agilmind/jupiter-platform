# Ref: https://mozilla.github.io/server-side-tls/ssl-config-generator/
# Ref: https://cipherli.st/

# Protocolos modernos recomendados
ssl_protocols TLSv1.2 TLSv1.3;

# Ciphers preferidos (Ordenados por preferencia)
# TLS 1.3 Ciphers (automáticamente preferidos si TLSv1.3 está habilitado)
# ssl_ciphers TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256; # Comentado ya que Nginx maneja esto bien por defecto con TLS 1.3
# TLS 1.2 Ciphers (Intermediate compatibility)
ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;
ssl_prefer_server_ciphers off; # Usar 'on' si quieres forzar el orden del servidor, 'off' permite más flexibilidad al cliente

# Configuración de Sesión SSL
ssl_session_timeout 1d; # Tiempo que una sesión puede ser reutilizada
ssl_session_cache shared:SSL:10m; # Tamaño del caché de sesión (10MB ~ 40000 sesiones)
ssl_session_tickets off; # Deshabilitar Session Tickets por seguridad (Perfect Forward Secrecy)

# OCSP Stapling - Mejora la velocidad de conexión SSL
# Necesita un resolver configurado en el bloque http de nginx.conf principal (que no estamos gestionando aquí)
# ssl_stapling on;
# ssl_stapling_verify on;
# resolver 8.8.8.8 8.8.4.4 valid=300s; # Ejemplo con Google DNS (poner en bloque http)
# resolver_timeout 5s;

# HTTP Strict Transport Security (HSTS) - ¡Importante!
# Descomentar DESPUÉS de verificar que HTTPS funciona perfectamente.
# Duración de 1 año (en segundos). includeSubDomains es opcional. preload es para enviar a listas de precarga HSTS.
# add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# Otros Headers de Seguridad (ya los teníamos en default.conf, pero pueden ir aquí)
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header Referrer-Policy "no-referrer-when-downgrade" always;
# add_header Content-Security-Policy "..."; # CSP específico de tu aplicación

# Reducción de información
server_tokens off; # No mostrar versión de Nginx en errores/headers
